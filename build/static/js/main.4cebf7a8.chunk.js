(this["webpackJsonpnew-app"]=this["webpackJsonpnew-app"]||[]).push([[0],{197:function(e,t,n){},198:function(e,t,n){"use strict";n.r(t);var r=n(5),i=n(0),a=n.n(i),c=n(22),s=n.n(c),o=n(51),u=n.n(o),l=n(78),d=n(36),j=n(104),b=function(e,t,n){var a=Object(i.createContext)(n);return{Context:a,Provider:function(c){var s=c.children,o=Object(i.useReducer)(e,n),u=Object(j.a)(o,2),l=u[0],b=u[1],O={};for(var f in t)O[f]=t[f](b);return Object(r.jsx)(a.Provider,{value:Object(d.a)({state:l},O),children:s})}}},O=n(140),f=Object({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}),h=f.REACT_APP_APP_ID,p=(f.REACT_APP_REDIRECT_URI,f.REACT_APP_MSAL_SCOPES,f.REACT_APP_AZURE_AUTHORITY),g={auth:{clientId:h,redirectUri:window.location.origin,authority:p,postLogoutRedirectUri:window.location.origin}},x=new O.a(g),v={scopes:["user.read","mailboxsettings.read","calendars.readwrite"]},m=function(){var e=Object(l.a)(u.a.mark((function e(){var t,n,r,i;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=x.getAllAccounts(),e.prev=1,!((null===t||void 0===t?void 0:t.length)<=0)){e.next=4;break}throw new Error("login_required");case 4:return e.next=6,x.acquireTokenSilent({scopeRequestConfig:v,account:t[0]});case 6:return n=e.sent,e.abrupt("return",{token:n.accessToken,idToken:n.idToken,account:t[0]});case 10:if(e.prev=10,e.t0=e.catch(1),!C(e.t0)){e.next=20;break}return e.next=15,x.loginPopup(v);case 15:return r=e.sent,i=x.getAllAccounts(),e.abrupt("return",{token:r.accessToken,idToken:r.idToken,account:i[0]});case 20:throw e.t0;case 21:case"end":return e.stop()}}),e,null,[[1,10]])})));return function(){return e.apply(this,arguments)}}(),C=function(e){return!(!e.message||e.message.length<=0)&&(e.message.indexOf("consent_required")>-1||e.message.indexOf("interaction_required")>-1||e.message.indexOf("login_required")>-1||e.message.indexOf("no_account_in_silent_request")>-1)},P=function(e){var t=e.split(".")[1].replace(/-/g,"+").replace(/_/g,"/"),n=decodeURIComponent(atob(t).split("").map((function(e){return"%"+("00"+e.charCodeAt(0).toString(16)).slice(-2)})).join(""));return JSON.parse(n)},_=function(e){var t,n;return(null===e||void 0===e?void 0:e.roles)instanceof Array?null===e||void 0===e||null===(t=e.roles[0])||void 0===t?void 0:t.toUpperCase():null===e||void 0===e||null===(n=e.roles)||void 0===n?void 0:n.toUpperCase()},A="auth/add_error",k="auth/login",y="auth/signOut",S="auth/clearError",T="auth/setUser",E={isAuthenticated:!1,token:null,username:null,role:null,errorMessage:""},N=b((function(e,t){switch(t.type){case A:return Object(d.a)(Object(d.a)({},e),{},{errorMessage:t.payload});case k:return{username:t.payload.name,isAuthenticated:!0,errorMessage:"",token:t.payload.token,role:t.payload.role};case S:return Object(d.a)(Object(d.a)({},e),{},{errorMessage:""});case y:return E;case T:return Object(d.a)(Object(d.a)({},e),{},{username:t.payload});default:return e}}),{signIn:function(e){return Object(l.a)(u.a.mark((function t(){var n,r,i,a,c,s;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,m();case 2:n=t.sent,r=n.token,i=n.account,a=n.idToken,c=P(a),s=_(c),e({type:k,payload:{token:r,name:i.name,role:s}});case 9:case"end":return t.stop()}}),t)})))},signOut:function(e){return Object(l.a)(u.a.mark((function t(){return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,x.logout();case 2:e({type:y});case 3:case"end":return t.stop()}}),t)})))},changeName:function(e){return function(){e({type:T,payload:"Ambrosio"})}}},E),w=N.Provider,R=N.Context,I="notifications/addNotification",U="notifications/clearNotification",q=b((function(e,t){switch(t.type){case I:return{visible:!0,message:t.payload};case U:return{visible:!1,message:""};default:return e}}),{setNotification:function(e){return function(t){e({type:I,payload:t}),setTimeout((function(){return e({type:U})}),1e3)}},clearNotifications:function(e){return function(){e({type:U})}}},{message:void 0,visible:!1}),L=q.Provider,M=q.Context,D=function(e){var t=e.children;return Object(r.jsx)(L,{children:Object(r.jsx)(w,{children:t})})},B=n(116),F=n(10),z=n(20),H=Object(z.a)(),Z=n(213),G=n(141),J=n(149),K=function(e){return RegExp("^([A-Za-z0-9+/]{4})*([A-Za-z0-9+/]{3}=|[A-Za-z0-9+/]{2}==)?$").test(e)},W=Object(i.lazy)((function(){return Promise.resolve().then(n.bind(null,141))})),V=Object(i.lazy)((function(){return Promise.resolve().then(n.bind(null,149))})),Y=function(){var e=Object(i.useContext)(R).state,t=[G.metadata,J.metadata];return{dashBoardsList:t.map((function(t,n){return{title:t.title,description:t.description,icon:t.icon,slug:"/".concat((a=t.title,a.replace(/\s+/g,"-").toLowerCase())),requiredPermissions:t.requiredPermissions,component:(i=["APP_".concat(n+1)],{APP_1:Object(r.jsx)(W,{state:e}),APP_2:Object(r.jsx)(V,{state:e})}[i])};var i,a}))}},$=n(212),Q={SUPER_ADMIN:"SUPER.ADMIN",ADMIN:"ADMIN",GUEST:"GUEST"},X="Not so fast!",ee=function(e,t){var n=Object.values(Q),r=null===e||void 0===e?void 0:e.sort((function(e,t){return n.indexOf(e)-n.indexOf(t)})),i=r[r.length-1],a=n.indexOf(t),c=n.indexOf(i.toUpperCase());return!(a<0)&&(!!e.includes(t)||a<=c)},te=function(){var e=Object(F.g)(),t=Object(i.useContext)(M).setNotification;return{navigateSafely:function(n,r,i){n&&r&&(ee(n,r)?e.push(i):t(X))}}},ne=function(e){var t,n=e.dasboard,a=Object(i.useContext)(R).state.role,c=te().navigateSafely;return Object(r.jsx)($.a,{link:!0,header:(t=n,Object(r.jsxs)("div",{className:"dashboard-card",children:[Object(r.jsx)("span",{children:t.title}),Object(r.jsx)("img",{alt:t.title,src:K(t.icon)?"data:image/jpeg;base64,".concat(t.icon):t.icon})]})),meta:n.requiredPermissions.join(", "),description:n.description,onClick:function(){return c(n.requiredPermissions,a,n.slug)}})},re=function(){var e=Object(i.useContext)(R).changeName,t=Y().dashBoardsList;return Object(r.jsx)("div",{className:"h-main-segment",children:Object(r.jsxs)("div",{className:"h-flex-column",children:[Object(r.jsxs)("div",{children:[Object(r.jsx)("h3",{children:"Main dashboard"}),Object(r.jsx)(Z.a,{content:"Change name",primary:!0,onClick:e})]}),Object(r.jsx)("div",{className:"dashboard",children:t.map((function(e){return Object(r.jsx)(ne,{dasboard:e},e.slug)}))})]})})},ie=function(e){var t=e.children,n=e.dashboard,a=Object(i.useContext)(R).state.role;return function(e,t){var n=Object(i.useContext)(M).setNotification,r=Object(F.g)();Object(i.useEffect)((function(){t||(n(X),r.push("/")),t&&e&&(ee(e,t)||(r.push("/"),n(X)))}),[e,t])}(n.requiredPermissions,a),Object(r.jsx)("div",{className:"h-main-segment",children:t})},ae=n(210),ce=function(){var e=Object(i.useContext)(R),t=e.state,n=t.username,a=t.isAuthenticated,c=e.signOut,s=e.signIn;return Object(r.jsx)("div",{className:"top-navbar",children:a?Object(r.jsx)(ae.a,{className:"h-font-weight-bold",text:n,children:Object(r.jsx)(ae.a.Menu,{children:Object(r.jsx)(ae.a.Item,{icon:"sign-out",text:"Sign out",onClick:c})})}):Object(r.jsx)("span",{className:"h-font-weight-bold",onClick:s,children:"Sign in"})})},se=n(148),oe=n(215),ue=n(211),le={title:"Volvo",slug:"/",icon:n.p+"static/media/assets-logo-icon.7bb66355.png",requiredPermissions:[Q.GUEST]},de=function(){var e=Object(i.useContext)(R).state.role,t=Y().dashBoardsList,n=Object(i.useState)(le.slug),a=Object(j.a)(n,2),c=a[0],s=a[1],o=te().navigateSafely;return Object(r.jsx)(oe.a,{as:ue.a,animation:"overlay",direction:"left",icon:"labeled",inverted:!0,vertical:!0,visible:!0,width:"thin",children:[le].concat(Object(se.a)(t)).map((function(t){return Object(r.jsxs)(ue.a.Item,{className:"side-navbar-item",as:"a",active:c===t.slug,onClick:function(){return n=t.requiredPermissions,r=t.slug,s(r),void o(n,e,r);var n,r},children:[Object(r.jsx)("img",{className:"side-navbar-item-logo",src:K(t.icon)?"data:image/jpeg;base64,".concat(t.icon):t.icon,alt:t.title}),Object(r.jsx)("span",{children:t.title})]},t.slug)}))})},je=n(120),be=(n(136),function(){return Object(r.jsx)(je.a,{autoClose:3e3,hideProgressBar:!0,closeOnClick:!0})}),Oe=je.b,fe=function(){var e=Object(i.useContext)(R).signIn,t=Object(i.useContext)(M).state,n=t.message,a=t.visible,c=Y().dashBoardsList;return Object(i.useEffect)((function(){e()}),[]),Object(i.useEffect)((function(){n&&a&&Oe(n)}),[n,a]),Object(r.jsxs)(B.a,{history:H,children:[Object(r.jsx)(be,{}),Object(r.jsx)(ce,{}),Object(r.jsx)(de,{}),Object(r.jsxs)(F.d,{children:[Object(r.jsxs)(i.Suspense,{fallback:Object(r.jsx)("div",{children:"Loading..."}),children:[Object(r.jsx)(F.b,{exact:!0,path:"/",component:re}),null===c||void 0===c?void 0:c.map((function(e){return Object(r.jsx)(F.b,{path:e.slug,exact:!0,render:function(){return Object(r.jsx)(ie,{dashboard:e,children:e.component})}},e.slug)}))]}),Object(r.jsx)(F.b,{path:"*",children:Object(r.jsx)(F.a,{to:"/"})})]})]})},he=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,216)).then((function(t){var n=t.getCLS,r=t.getFID,i=t.getFCP,a=t.getLCP,c=t.getTTFB;n(e),r(e),i(e),a(e),c(e)}))};n(197);s.a.render(Object(r.jsx)(a.a.StrictMode,{children:Object(r.jsx)(D,{children:Object(r.jsx)(fe,{})})}),document.getElementById("root")),he()}},[[198,1,2]]]);
//# sourceMappingURL=main.4cebf7a8.chunk.js.map