{"ast":null,"code":"var _s = $RefreshSig$(),\n    _s2 = $RefreshSig$();\n\nimport { useEffect, useContext } from 'react';\nimport { useHistory } from 'react-router-dom';\nimport { PERMISSIONS } from '../../consts/permissions/permissions.consts';\nimport { Context as NotificationsContext } from '../../context/notifications/NotificationsContext';\nimport { DEFAULT_NOTIFICATIONS } from '../../consts/notifications/notifications.consts';\nexport const userHasPermission = (permissionToCheck, role) => {\n  const permissionsArray = Object.values(PERMISSIONS);\n  const sortedPermissionsToCheck = permissionToCheck === null || permissionToCheck === void 0 ? void 0 : permissionToCheck.sort((a, b) => permissionsArray.indexOf(a) - permissionsArray.indexOf(b));\n  const bottomPermission = sortedPermissionsToCheck[sortedPermissionsToCheck.length - 1];\n  const userRoleIndex = permissionsArray.indexOf(role);\n  const permissionToCheckIndex = permissionsArray.indexOf(bottomPermission.toUpperCase());\n  if (userRoleIndex < 0) return false;\n  if (permissionToCheck.includes(role)) return true;\n  return userRoleIndex <= permissionToCheckIndex;\n};\nexport const useProtectedNavigation = () => {\n  _s();\n\n  const history = useHistory();\n  const {\n    setNotification\n  } = useContext(NotificationsContext);\n\n  const navigateSafely = (requiredPermission, role, link) => {\n    if (requiredPermission && role) {\n      if (userHasPermission(requiredPermission, role)) {\n        history.push(link);\n      } else {\n        setNotification(DEFAULT_NOTIFICATIONS.notAllowed);\n      }\n    }\n  };\n\n  return {\n    navigateSafely\n  };\n};\n\n_s(useProtectedNavigation, \"Q2UzlBob8zCTa6Tcrk+456NLH6E=\", false, function () {\n  return [useHistory];\n});\n\nexport const usePrivateRoute = (permissionToCheck, role) => {\n  _s2();\n\n  const {\n    setNotification\n  } = useContext(NotificationsContext);\n  const history = useHistory();\n  useEffect(() => {\n    if (!role) {\n      setNotification(DEFAULT_NOTIFICATIONS.notAllowed);\n      history.push('/');\n    }\n\n    if (role && permissionToCheck) {\n      if (!userHasPermission(permissionToCheck, role)) {\n        history.push('/');\n        setNotification(DEFAULT_NOTIFICATIONS.notAllowed);\n      }\n    }\n  }, [permissionToCheck, role]);\n};\n\n_s2(usePrivateRoute, \"Kc4k18kvYrYbmpwFtnlyhzPRqD8=\", false, function () {\n  return [useHistory];\n});","map":{"version":3,"sources":["/Users/rubenbernardes/Code/freelance/volvo/azure-context/src/utils/permissions/useUserHasPermission.util.js"],"names":["useEffect","useContext","useHistory","PERMISSIONS","Context","NotificationsContext","DEFAULT_NOTIFICATIONS","userHasPermission","permissionToCheck","role","permissionsArray","Object","values","sortedPermissionsToCheck","sort","a","b","indexOf","bottomPermission","length","userRoleIndex","permissionToCheckIndex","toUpperCase","includes","useProtectedNavigation","history","setNotification","navigateSafely","requiredPermission","link","push","notAllowed","usePrivateRoute"],"mappings":";;;AAAA,SAASA,SAAT,EAAoBC,UAApB,QAAsC,OAAtC;AACA,SAASC,UAAT,QAA2B,kBAA3B;AACA,SAASC,WAAT,QAA4B,6CAA5B;AACA,SAASC,OAAO,IAAIC,oBAApB,QAAgD,kDAAhD;AACA,SAASC,qBAAT,QAAsC,iDAAtC;AAEA,OAAO,MAAMC,iBAAiB,GAAG,CAACC,iBAAD,EAAoBC,IAApB,KAA6B;AAC5D,QAAMC,gBAAgB,GAAGC,MAAM,CAACC,MAAP,CAAcT,WAAd,CAAzB;AACA,QAAMU,wBAAwB,GAAGL,iBAAH,aAAGA,iBAAH,uBAAGA,iBAAiB,CAAEM,IAAnB,CAAwB,CAACC,CAAD,EAAIC,CAAJ,KAAUN,gBAAgB,CAACO,OAAjB,CAAyBF,CAAzB,IAA8BL,gBAAgB,CAACO,OAAjB,CAAyBD,CAAzB,CAAhE,CAAjC;AACA,QAAME,gBAAgB,GAAGL,wBAAwB,CAACA,wBAAwB,CAACM,MAAzB,GAAkC,CAAnC,CAAjD;AACA,QAAMC,aAAa,GAAGV,gBAAgB,CAACO,OAAjB,CAAyBR,IAAzB,CAAtB;AACA,QAAMY,sBAAsB,GAAGX,gBAAgB,CAACO,OAAjB,CAAyBC,gBAAgB,CAACI,WAAjB,EAAzB,CAA/B;AAEA,MAAIF,aAAa,GAAG,CAApB,EAAuB,OAAO,KAAP;AACvB,MAAIZ,iBAAiB,CAACe,QAAlB,CAA2Bd,IAA3B,CAAJ,EAAsC,OAAO,IAAP;AACtC,SAAOW,aAAa,IAAIC,sBAAxB;AACD,CAVM;AAYP,OAAO,MAAMG,sBAAsB,GAAG,MAAM;AAAA;;AAC1C,QAAMC,OAAO,GAAGvB,UAAU,EAA1B;AACA,QAAM;AAACwB,IAAAA;AAAD,MAAoBzB,UAAU,CAACI,oBAAD,CAApC;;AAEA,QAAMsB,cAAc,GAAG,CAACC,kBAAD,EAAqBnB,IAArB,EAA2BoB,IAA3B,KAAoC;AACzD,QAAID,kBAAkB,IAAInB,IAA1B,EAAgC;AAC9B,UAAIF,iBAAiB,CAACqB,kBAAD,EAAqBnB,IAArB,CAArB,EAAiD;AAC/CgB,QAAAA,OAAO,CAACK,IAAR,CAAaD,IAAb;AACD,OAFD,MAEO;AACLH,QAAAA,eAAe,CAACpB,qBAAqB,CAACyB,UAAvB,CAAf;AACD;AACF;AACF,GARD;;AAUA,SAAO;AAAEJ,IAAAA;AAAF,GAAP;AACD,CAfM;;GAAMH,sB;UACKtB,U;;;AAgBlB,OAAO,MAAM8B,eAAe,GAAG,CAACxB,iBAAD,EAAoBC,IAApB,KAA6B;AAAA;;AAC1D,QAAM;AAACiB,IAAAA;AAAD,MAAoBzB,UAAU,CAACI,oBAAD,CAApC;AACA,QAAMoB,OAAO,GAAGvB,UAAU,EAA1B;AAEAF,EAAAA,SAAS,CAAC,MAAM;AACd,QAAI,CAACS,IAAL,EAAW;AACTiB,MAAAA,eAAe,CAACpB,qBAAqB,CAACyB,UAAvB,CAAf;AACAN,MAAAA,OAAO,CAACK,IAAR,CAAa,GAAb;AACD;;AACD,QAAIrB,IAAI,IAAID,iBAAZ,EAA+B;AAC7B,UAAI,CAACD,iBAAiB,CAACC,iBAAD,EAAoBC,IAApB,CAAtB,EAAiD;AAC/CgB,QAAAA,OAAO,CAACK,IAAR,CAAa,GAAb;AACAJ,QAAAA,eAAe,CAACpB,qBAAqB,CAACyB,UAAvB,CAAf;AACD;AACF;AACF,GAXQ,EAWN,CAACvB,iBAAD,EAAoBC,IAApB,CAXM,CAAT;AAYD,CAhBM;;IAAMuB,e;UAEK9B,U","sourcesContent":["import { useEffect, useContext } from 'react';\nimport { useHistory } from 'react-router-dom';\nimport { PERMISSIONS } from '../../consts/permissions/permissions.consts';\nimport { Context as NotificationsContext } from '../../context/notifications/NotificationsContext';\nimport { DEFAULT_NOTIFICATIONS } from '../../consts/notifications/notifications.consts';\n\nexport const userHasPermission = (permissionToCheck, role) => {\n  const permissionsArray = Object.values(PERMISSIONS);\n  const sortedPermissionsToCheck = permissionToCheck?.sort((a, b) => permissionsArray.indexOf(a) - permissionsArray.indexOf(b));\n  const bottomPermission = sortedPermissionsToCheck[sortedPermissionsToCheck.length - 1];\n  const userRoleIndex = permissionsArray.indexOf(role);\n  const permissionToCheckIndex = permissionsArray.indexOf(bottomPermission.toUpperCase());\n\n  if (userRoleIndex < 0) return false\n  if (permissionToCheck.includes(role)) return true\n  return userRoleIndex <= permissionToCheckIndex;\n};\n\nexport const useProtectedNavigation = () => {\n  const history = useHistory();\n  const {setNotification} = useContext(NotificationsContext);\n\n  const navigateSafely = (requiredPermission, role, link) => {\n    if (requiredPermission && role) {\n      if (userHasPermission(requiredPermission, role)) {\n        history.push(link)\n      } else {\n        setNotification(DEFAULT_NOTIFICATIONS.notAllowed)\n      }\n    }\n  }\n\n  return { navigateSafely }\n}\n\nexport const usePrivateRoute = (permissionToCheck, role) => {\n  const {setNotification} = useContext(NotificationsContext);\n  const history = useHistory();\n\n  useEffect(() => {\n    if (!role) {\n      setNotification(DEFAULT_NOTIFICATIONS.notAllowed)\n      history.push('/');\n    }\n    if (role && permissionToCheck) {\n      if (!userHasPermission(permissionToCheck, role)) {\n        history.push('/');\n        setNotification(DEFAULT_NOTIFICATIONS.notAllowed)\n      }\n    }\n  }, [permissionToCheck, role]);\n};\n"]},"metadata":{},"sourceType":"module"}