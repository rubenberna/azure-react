{"ast":null,"code":"var _s = $RefreshSig$();\n\nimport { useEffect } from 'react';\nimport { useHistory } from 'react-router-dom';\nimport { PERMISSIONS } from '../consts/permissions.consts';\nexport const userHasPermission = (permissionToCheck, role) => {\n  const permissionsArray = Object.values(PERMISSIONS);\n  const sortedPermissionsToCheck = permissionToCheck === null || permissionToCheck === void 0 ? void 0 : permissionToCheck.sort((a, b) => permissionsArray.indexOf(a) - permissionsArray.indexOf(b));\n  const bottomPermission = sortedPermissionsToCheck[sortedPermissionsToCheck.length - 1]; // Check if user role is included in required permissions\n\n  if (permissionToCheck.includes(role)) {\n    return true;\n  } // Check if user role is higher in hierarchy than the bottom permission of the dashboard\n\n\n  const userRoleIndex = permissionsArray.indexOf(role);\n  const permissionToCheckIndex = permissionsArray.indexOf(bottomPermission.toUpperCase());\n  return userRoleIndex <= permissionToCheckIndex;\n};\nexport const usePrivateRoute = (permissionToCheck, role) => {\n  _s();\n\n  console.log(permissionToCheck);\n  const history = useHistory();\n  useEffect(() => {\n    console.log('checking this');\n\n    if (!role) {\n      history.push('/');\n    }\n\n    if (role && permissionToCheck) {\n      !userHasPermission(permissionToCheck, role) && history.push('/');\n    }\n  }, [permissionToCheck, role]);\n};\n\n_s(usePrivateRoute, \"bz2N+u0mX89LO9zOCfVCA9Sa20M=\", false, function () {\n  return [useHistory];\n});","map":{"version":3,"sources":["/Users/rubenbernardes/Code/freelance/volvo/azure-context/src/utils/useUserHasPermission.util.js"],"names":["useEffect","useHistory","PERMISSIONS","userHasPermission","permissionToCheck","role","permissionsArray","Object","values","sortedPermissionsToCheck","sort","a","b","indexOf","bottomPermission","length","includes","userRoleIndex","permissionToCheckIndex","toUpperCase","usePrivateRoute","console","log","history","push"],"mappings":";;AAAA,SAASA,SAAT,QAA0B,OAA1B;AACA,SAASC,UAAT,QAA2B,kBAA3B;AACA,SAASC,WAAT,QAA4B,8BAA5B;AAEA,OAAO,MAAMC,iBAAiB,GAAG,CAACC,iBAAD,EAAoBC,IAApB,KAA6B;AAE5D,QAAMC,gBAAgB,GAAGC,MAAM,CAACC,MAAP,CAAcN,WAAd,CAAzB;AACA,QAAMO,wBAAwB,GAAGL,iBAAH,aAAGA,iBAAH,uBAAGA,iBAAiB,CAAEM,IAAnB,CAAwB,CAACC,CAAD,EAAIC,CAAJ,KAAUN,gBAAgB,CAACO,OAAjB,CAAyBF,CAAzB,IAA8BL,gBAAgB,CAACO,OAAjB,CAAyBD,CAAzB,CAAhE,CAAjC;AACA,QAAME,gBAAgB,GAAGL,wBAAwB,CAACA,wBAAwB,CAACM,MAAzB,GAAkC,CAAnC,CAAjD,CAJ4D,CAM5D;;AACA,MAAIX,iBAAiB,CAACY,QAAlB,CAA2BX,IAA3B,CAAJ,EAAsC;AACpC,WAAO,IAAP;AACD,GAT2D,CAW5D;;;AACA,QAAMY,aAAa,GAAGX,gBAAgB,CAACO,OAAjB,CAAyBR,IAAzB,CAAtB;AACA,QAAMa,sBAAsB,GAAGZ,gBAAgB,CAACO,OAAjB,CAAyBC,gBAAgB,CAACK,WAAjB,EAAzB,CAA/B;AAEA,SAAOF,aAAa,IAAIC,sBAAxB;AACD,CAhBM;AAkBP,OAAO,MAAME,eAAe,GAAG,CAAChB,iBAAD,EAAoBC,IAApB,KAA6B;AAAA;;AAC1DgB,EAAAA,OAAO,CAACC,GAAR,CAAYlB,iBAAZ;AACA,QAAMmB,OAAO,GAAGtB,UAAU,EAA1B;AAEAD,EAAAA,SAAS,CAAC,MAAM;AACdqB,IAAAA,OAAO,CAACC,GAAR,CAAY,eAAZ;;AACA,QAAI,CAACjB,IAAL,EAAW;AACTkB,MAAAA,OAAO,CAACC,IAAR,CAAa,GAAb;AACD;;AACD,QAAInB,IAAI,IAAID,iBAAZ,EAA+B;AAC7B,OAACD,iBAAiB,CAACC,iBAAD,EAAoBC,IAApB,CAAlB,IAA+CkB,OAAO,CAACC,IAAR,CAAa,GAAb,CAA/C;AACD;AACF,GARQ,EAQN,CAACpB,iBAAD,EAAoBC,IAApB,CARM,CAAT;AASD,CAbM;;GAAMe,e;UAEKnB,U","sourcesContent":["import { useEffect } from 'react';\nimport { useHistory } from 'react-router-dom';\nimport { PERMISSIONS } from '../consts/permissions.consts';\n\nexport const userHasPermission = (permissionToCheck, role) => {\n\n  const permissionsArray = Object.values(PERMISSIONS);\n  const sortedPermissionsToCheck = permissionToCheck?.sort((a, b) => permissionsArray.indexOf(a) - permissionsArray.indexOf(b));\n  const bottomPermission = sortedPermissionsToCheck[sortedPermissionsToCheck.length - 1];\n\n  // Check if user role is included in required permissions\n  if (permissionToCheck.includes(role)) {\n    return true;\n  }\n\n  // Check if user role is higher in hierarchy than the bottom permission of the dashboard\n  const userRoleIndex = permissionsArray.indexOf(role);\n  const permissionToCheckIndex = permissionsArray.indexOf(bottomPermission.toUpperCase());\n\n  return userRoleIndex <= permissionToCheckIndex;\n};\n\nexport const usePrivateRoute = (permissionToCheck, role) => {\n  console.log(permissionToCheck);\n  const history = useHistory();\n\n  useEffect(() => {\n    console.log('checking this');\n    if (!role) {\n      history.push('/');\n    }\n    if (role && permissionToCheck) {\n      !userHasPermission(permissionToCheck, role) && history.push('/');\n    }\n  }, [permissionToCheck, role]);\n};"]},"metadata":{},"sourceType":"module"}